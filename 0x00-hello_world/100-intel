#!/bin/bash
# Generate assembly code (Intel syntax) from C code and save it in an output file

# Check if the CFILE variable is set
if [ -z "$CFILE" ]; then
  echo "CFILE variable is not set. Please set it to the C file name."
  exit 1
fi

# Check if the C file exists
if [ ! -f "$CFILE" ]; then
  echo "C file '$CFILE' does not exist."
  exit 1
fi

# Extract the file name without extension
FILENAME=$(basename "$CFILE" .c)

# Generate the assembly code and save it to the output file
gcc -S -masm=intel "$CFILE" -o "$FILENAME.s"

# Check if the compilation was successful
if [ $? -eq 0 ]; then
  echo "Assembly code generated and saved to '$FILENAME.s'."
else
  echo "Failed to generate assembly code."
fi
